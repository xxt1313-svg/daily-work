<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å“¡å·¥æ’ç¨‹ç³»çµ±</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Microsoft JhengHei", sans-serif; background: #f8fafc; }
        .header { background: linear-gradient(135deg, #2563eb, #1e40af); color: white; padding: 1.25rem 1rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; }
        .header h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .date-bar { display: flex; gap: 0.5rem; margin-top: 0.75rem; }
        .date-bar input { flex: 1; padding: 0.75rem; border: none; border-radius: 0.5rem; font-size: 1rem; }
        .container { max-width: 800px; margin: 0 auto; padding: 1rem 1rem 5rem; }
        .staff-card { background: white; border-radius: 1rem; padding: 1rem; margin-bottom: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border: 2px solid #e2e8f0; }
        .staff-name { font-size: 1.25rem; font-weight: 700; color: #2563eb; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 2px solid #e2e8f0; }
        .shift-section { margin-bottom: 1rem; }
        .shift-label { display: inline-flex; align-items: center; gap: 0.375rem; font-size: 0.875rem; font-weight: 600; color: white; background: linear-gradient(135deg, #f59e0b, #d97706); padding: 0.375rem 0.75rem; border-radius: 0.375rem; margin-bottom: 0.75rem; }
        .shift-label.pm { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
        .form-group { margin-bottom: 0.75rem; }
        .form-label { display: block; font-size: 0.875rem; font-weight: 600; color: #64748b; margin-bottom: 0.375rem; }
        .custom-select { width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 0.5rem; font-size: 1rem; background: white; }
        .product-selector { border: 2px solid #e2e8f0; border-radius: 0.5rem; padding: 0.75rem; background: white; }
        .product-search { width: 100%; padding: 0.625rem; border: 2px solid #e2e8f0; border-radius: 0.375rem; font-size: 0.875rem; margin-bottom: 0.75rem; }
        .product-list { max-height: 200px; overflow-y: auto; }
        .product-item { display: flex; align-items: flex-start; gap: 0.75rem; padding: 0.75rem; border-radius: 0.375rem; margin-bottom: 0.5rem; cursor: pointer; border: 2px solid transparent; }
        .product-item:hover { background: #f8fafc; }
        .product-item.selected { background: #dbeafe; border-color: #2563eb; }
        .product-checkbox { width: 1.25rem; height: 1.25rem; }
        .product-code { font-weight: 700; color: #2563eb; font-size: 0.875rem; }
        .product-name { font-size: 0.875rem; margin-top: 0.125rem; }
        .selected-products { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem; min-height: 2rem; }
        .product-badge { display: inline-flex; align-items: center; gap: 0.375rem; background: #2563eb; color: white; padding: 0.375rem 0.625rem; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600; }
        .remove-badge { background: rgba(255,255,255,0.3); border: none; color: white; width: 1.125rem; height: 1.125rem; border-radius: 50%; cursor: pointer; }
        .custom-textarea { width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 0.5rem; font-size: 0.875rem; font-family: inherit; resize: vertical; min-height: 60px; }
        .bottom-actions { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 1rem; box-shadow: 0 -4px 6px rgba(0,0,0,0.1); display: flex; gap: 0.75rem; z-index: 50; }
        .btn { flex: 1; padding: 0.875rem; border: none; border-radius: 0.5rem; font-size: 1rem; font-weight: 700; cursor: pointer; }
        .btn-primary { background: #2563eb; color: white; }
        .btn-success { background: #10b981; color: white; }
        .toast { position: fixed; top: 5rem; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 1rem 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.2); font-weight: 600; z-index: 200; opacity: 0; transition: opacity 0.3s; }
        .toast.show { opacity: 1; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“… å“¡å·¥æ’ç¨‹ç³»çµ±</h1>
        <div class="date-bar">
            <input type="date" id="scheduleDate" />
        </div>
    </div>
    <div class="container" id="scheduleContainer"></div>
    <div class="bottom-actions">
        <button class="btn btn-primary" onclick="clearAll()">æ¸…ç©º</button>
        <button class="btn btn-success" onclick="saveSchedule()">ğŸ’¾ å„²å­˜</button>
    </div>
    <div class="toast" id="toast"></div>
    <script>

const SCHEDULE_DATA = {
        "staffList": [
                "é‚±é›ªè“‰",
                "å¼µæ–‡è¼",
                "é»ƒæ–‡æƒ…",
                "ææ–‡æ…¶",
                "è¶™æ–‡ä¸Š",
                "é˜®æ–‡åš",
                "æ—æ˜Ÿæ",
                "è³´æµ·ç™»"
        ],
        "workItems": [
                {
                        "code": "1",
                        "name_cn": "å€’èŠ±ç”Ÿ",
                        "name_vn": "Äá»• hoa sinh"
                },
                {
                        "code": "2",
                        "name_cn": "èŠ±ç”Ÿè„«æ®¼",
                        "name_vn": "BÃ³c vá» hoa sinh"
                },
                {
                        "code": "3",
                        "name_cn": "è£èŠ±ç”Ÿæ®¼",
                        "name_vn": "ÄÃ³ng vá» hoa sinh"
                },
                {
                        "code": "4",
                        "name_cn": "é›»è…¦é¸èŠ±ç”Ÿ",
                        "name_vn": "Chá»n hoa sinh báº±ng mÃ¡y"
                },
                {
                        "code": "5",
                        "name_cn": "å…¥å†°åº«",
                        "name_vn": "Nháº­p kho láº¡nh"
                },
                {
                        "code": "6",
                        "name_cn": "èŠ±ç”ŸåŠ å·¥",
                        "name_vn": "Cháº¿ biáº¿n hoa sinh"
                },
                {
                        "code": "7",
                        "name_cn": "é€è²¨",
                        "name_vn": "Giao hÃ ng"
                },
                {
                        "code": "8",
                        "name_cn": "å…¶ä»–",
                        "name_vn": "KhÃ¡c"
                }
        ],
        "products": [
                {
                        "code": "1101",
                        "name_cn": "ç”Ÿä»ã€Œç‰¹ã€SÃ¢ng ráº¥n \"thá»\"",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1102",
                        "name_cn": "ç”Ÿä»ã€Œé¦–ã€sÃ¢ng ráº¥n \" sáº©u \"",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1103",
                        "name_cn": "ç”Ÿä»ã€Œå¤§ä¸­ã€SÃ¢ng ráº¥n \" TÃ  Chung \"",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1104",
                        "name_cn": "è±†èŠ±ç”Ÿç‰‡ã€Œç‰¹ã€táº§u hoa sÃ¢ng pÃ¬an ' thá» '",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1105",
                        "name_cn": "è±†èŠ±ç”Ÿç‰‡ã€Œé¦–ã€táº§u hoa sÃ¢ng pÃ¬an ' sáº©u '",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1106",
                        "name_cn": "ç”Ÿä»ã€Œ9è™Ÿã€sÃ¢ng ráº¥n ' chiá»ƒu hÃ o '",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1107",
                        "name_cn": "å°ä¸­ xá»‰ao chung",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1108",
                        "name_cn": "å°¾ä»(ç‰‡)wuáº©y ráº¥n ( pÃ¬an)",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1109",
                        "name_cn": "ç”Ÿç‰‡ã€Œç‰¹ã€ã€Œæ¬¡ã€sÃ¢ng pÃ¬an ' thá» ' ' sá»« '",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1110",
                        "name_cn": "ç”Ÿç‰‡ã€Œé¦–ã€ã€Œæ¬¡ã€sÃ¢ng pÃ¬an ' sáº©u ' ' sá»«\"",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1201",
                        "name_cn": "æ²¹ç‚¸èŠ±ç”Ÿ Dáº¥u chÃ  hoa sÃ¢ng",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1202",
                        "name_cn": "æ²¹ç‚¸èŠ±ç”Ÿã€Œç‰¹ã€dáº¥u chÃ  hoa sÃ¢ng ' thá» '",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1203",
                        "name_cn": "è„†çš®ç”œèŠ±ç”Ÿ chuáº§y pÃ­ thiáº¿n hoa sÃ¢ng ",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1204",
                        "name_cn": "é¹½ç‚’èŠ±ç”Ÿ yÃ©n cháº£o hoa sÃ¢ng",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1205",
                        "name_cn": "å†°å“ç™½ç‰‡ping pá»‰n pÃ¡i pÃ¬an",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1206",
                        "name_cn": "ç±³æ¼¿é»‘ç‰‡má»‰ chiang hÃ¢y pÃ¬an",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1207",
                        "name_cn": "æ²¹ç‚¸èŠ±ç”Ÿç‰‡dáº¥u cháº£o hoa sÃ¢ng pÃ¬an",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1208",
                        "name_cn": "è’œå‘³èŠ±ç”Ÿç‰‡suÃ n wuáº§y hoa sÃ¢ng pÃ¬an",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1209",
                        "name_cn": "èŠ±ç”Ÿè§’ hoa sÃ¢ng chuáº¿ ( hoáº·c chá»‰ao) ",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1210",
                        "name_cn": "èŠ±ç”Ÿç²‰ã€Œç‰¹ã€ã€Œç²—ã€hoa sÃ¢ng pháº©n ' thá»' \"chu\"",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1211",
                        "name_cn": "èŠ±ç”Ÿç²‰ã€Œç‰¹ã€hoa sÃ¢ng pháº©n ' thá»\"",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1212",
                        "name_cn": "èŠ±ç”Ÿç²‰ã€Œé¦–ã€ã€Œç²—ã€Hoa sÃ¢ng pháº©n ' sáº©u\" \" chu \"",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1213",
                        "name_cn": "èŠ±ç”Ÿç²‰ã€Œé¦–ã€[Y]Hoa sÃ¢ng pháº©n \" sáº©u \" ( Y )",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1214",
                        "name_cn": "èŠ±ç”Ÿç²‰ã€Œé¦–ã€Hoa sÃ¢ng pháº©n \" sáº©u \"",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1215",
                        "name_cn": "1æ–¤æ²¹ y jin dáº¥u",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1216",
                        "name_cn": "1æ–¤ç”œ y jin thiáº¿n",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1217",
                        "name_cn": "1æ–¤ç‚’y jin cháº£o",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1218",
                        "name_cn": "1æ–¤æ²¹ç‰‡y jin dáº¥u pÃ¬an",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1219",
                        "name_cn": "1æ–¤è’œ y jin suÃ n",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1220",
                        "name_cn": "å°åŒ…æ²¹ xá»‰ao pao dáº¥u",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1221",
                        "name_cn": "å°åŒ…ç”œ xá»‰ao pao thiáº¿n",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1222",
                        "name_cn": "å°åŒ…ç‚’ xá»‰ao pao cháº£o",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1223",
                        "name_cn": "æ°´ç…®èŠ±ç”Ÿ suáº¥y chá»§ hoa sÃ¢ng",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1224",
                        "name_cn": "èŠ±ç”Ÿç²‰[KG] hoa sÃ¢ng pháº©n",
                        "name_vn": "å…¬æ–¤"
                },
                {
                        "code": "1225",
                        "name_cn": "èŠ±ç”Ÿç³– hoa sÃ¢ng thÃ¡ng",
                        "name_vn": "æ¡¶"
                },
                {
                        "code": "1226",
                        "name_cn": "é»‘èŠ±ç”Ÿç²’hÃ¢y hoa sÃ¢ng lÃ¬",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1227",
                        "name_cn": "è…°æœé…¥ dao cá»§a su ",
                        "name_vn": "æ¡¶"
                },
                {
                        "code": "1228",
                        "name_cn": "å†°å“ç™½ç‰‡[KG]ping pá»‰n pÃ¡i pÃ¬an",
                        "name_vn": "å…¬æ–¤"
                },
                {
                        "code": "1229",
                        "name_cn": "è ¶è±†é…¥ chÃ¡n tÃ u su",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "1301",
                        "name_cn": "9è™Ÿé¹½ç‚’èŠ±ç”Ÿè¢chiá»ƒu hÃ o yÃ©n cháº£o hoa sÃ¢ng chÃ¡",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "1302",
                        "name_cn": "9è™Ÿè’œå‘³èŠ±ç”Ÿè¢chiá»ƒu hÃ o suÃ n wuáº§y hoa sÃ¢ng chÃ¡",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "2101",
                        "name_cn": "ç”Ÿé»‘éº» sÃ¢ng hÃ¢y máº£",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "2102",
                        "name_cn": "ç”Ÿç™½éº» sÃ¢ng pÃ¡i máº£",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "2201",
                        "name_cn": "é»‘èŠéº»ç²’ hÃ¢y chÆ° máº£ lÃ¬",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "2202",
                        "name_cn": "é»‘èŠéº»ã€Œç²‰ã€hÃ¢y chÆ° máº£ \" pháº©n \"",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "2203",
                        "name_cn": "ç™½èŠéº»ç²’ pÃ¡i chÆ° máº£ lÃ¬ ",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "2204",
                        "name_cn": "ç™½èŠéº»ã€Œç²‰ã€PÃ¡i chÆ° máº£ \" Pháº©n \"",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "2205",
                        "name_cn": "é»‘èŠéº»ç²’ã€ŒKGã€HÃ¢y chÆ° máº£ lÃ¬",
                        "name_vn": "å…¬æ–¤"
                },
                {
                        "code": "2206",
                        "name_cn": "é»‘èŠéº»ã€Œç²‰ã€ã€ŒKGã€HÃ¢y chÆ° máº£ \"pháº©n\"",
                        "name_vn": "å…¬æ–¤"
                },
                {
                        "code": "2207",
                        "name_cn": "ç™½èŠéº»ç²’ã€ŒKGã€PÃ¡i chÆ° máº£ lÃ¬",
                        "name_vn": "å…¬æ–¤"
                },
                {
                        "code": "2208",
                        "name_cn": "ç™½èŠéº»ã€Œç²‰ã€ã€ŒKGã€ PÃ¡i chÆ° máº£ \" pháº©n \"",
                        "name_vn": "å…¬æ–¤"
                },
                {
                        "code": "2209",
                        "name_cn": "1æ–¤é»‘èŠéº»ã€Œç²‰ã€y jin hÃ¢y chÆ° máº£ \" pháº©n \"",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "3301",
                        "name_cn": "éº¥èŠ½ mÃ i dÃ¡",
                        "name_vn": "æ¡¶"
                },
                {
                        "code": "9901",
                        "name_cn": "ç³–ç²‰(æ•´è¢‹) thÃ¡ng pháº©n \" cháº©ng pao \"",
                        "name_vn": "è¢‹"
                },
                {
                        "code": "9902",
                        "name_cn": "ç³–ç²‰(10æ–¤) ThÃ¡ng Pháº©n ( sá»© jin )",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "9903",
                        "name_cn": "éº»æ²¹1æ–¤mÃ¡ dáº¥u y jin",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "9904",
                        "name_cn": "éº»æ²¹30æ–¤mÃ¡ dáº¥u san sá»© jin",
                        "name_vn": "æ¡¶"
                },
                {
                        "code": "9905",
                        "name_cn": "é¦™æ²¹ xiang dáº¥u",
                        "name_vn": "æ–¤"
                },
                {
                        "code": "9906",
                        "name_cn": "èŠ±ç”Ÿæ®¼hoa sÃ¢ng khá»›",
                        "name_vn": "åŒ…"
                },
                {
                        "code": "9907",
                        "name_cn": "é‹è²» yÃ¹n pháº§y ",
                        "name_vn": "å€‹"
                }
        ]
};

let currentSchedule = {};
document.getElementById('scheduleDate').valueAsDate = new Date();

function initSchedule() {
    SCHEDULE_DATA.staffList.forEach(staff => {
        currentSchedule[staff] = {
            am: { work: '', products: [], note: '' },
            pm: { work: '', products: [], note: '' }
        };
    });
}

function renderSchedule() {
    const container = document.getElementById('scheduleContainer');
    container.innerHTML = SCHEDULE_DATA.staffList.map(staff => createStaffCard(staff)).join('');
}

function createStaffCard(staff) {
    return `<div class="staff-card"><div class="staff-name">${staff}</div>${createShiftSection(staff, 'am', 'ğŸŒ… ä¸Šåˆ')}${createShiftSection(staff, 'pm', 'ğŸŒ† ä¸‹åˆ')}</div>`;
}

function createShiftSection(staff, shift, label) {
    return `<div class="shift-section"><div class="shift-label ${shift === 'pm' ? 'pm' : ''}">${label}</div><div class="form-group"><label class="form-label">å·¥ä½œé …ç›®</label><select class="custom-select" onchange="updateWork('${staff}', '${shift}', this.value)"><option value="">é¸æ“‡å·¥ä½œ...</option>${SCHEDULE_DATA.workItems.map(w => `<option value="${w.code}">${w.code} - ${w.name_cn} (${w.name_vn})</option>`).join('')}</select></div><div class="form-group"><label class="form-label">ç”¢å“é …ç›®ï¼ˆå¯è¤‡é¸ï¼‰</label><div class="product-selector"><input type="text" class="product-search" placeholder="ğŸ” æœå°‹ç”¢å“..." oninput="filterProducts('${staff}', '${shift}', this.value)"><div class="product-list" id="products-${staff}-${shift}">${renderProductList(staff, shift)}</div><div class="selected-products" id="selected-${staff}-${shift}">${renderSelectedProducts(staff, shift)}</div></div></div><div class="form-group"><label class="form-label">å‚™è¨»</label><textarea class="custom-textarea" placeholder="è¼¸å…¥å‚™è¨»..." oninput="updateNote('${staff}', '${shift}', this.value)"></textarea></div></div>`;
}

function renderProductList(staff, shift, filter = '') {
    const selectedProducts = currentSchedule[staff]?.[shift]?.products || [];
    return SCHEDULE_DATA.products.filter(p => !filter || p.code.toLowerCase().includes(filter.toLowerCase()) || p.name_cn.toLowerCase().includes(filter.toLowerCase())).map(product => {
        const isSelected = selectedProducts.includes(product.code);
        return `<div class="product-item ${isSelected ? 'selected' : ''}" onclick="toggleProduct('${staff}', '${shift}', '${product.code}')"><input type="checkbox" class="product-checkbox" ${isSelected ? 'checked' : ''} onclick="event.stopPropagation()"><div class="product-info"><div class="product-code">${product.code}</div><div class="product-name">${product.name_cn}</div></div></div>`;
    }).join('');
}

function renderSelectedProducts(staff, shift) {
    const selectedProducts = currentSchedule[staff]?.[shift]?.products || [];
    if (selectedProducts.length === 0) return '<div style="color: #64748b; font-size: 0.875rem;">å°šæœªé¸æ“‡ç”¢å“</div>';
    return selectedProducts.map(code => {
        const product = SCHEDULE_DATA.products.find(p => p.code === code);
        if (!product) return '';
        return `<div class="product-badge">${code} - ${product.name_cn}<button class="remove-badge" onclick="removeProduct('${staff}', '${shift}', '${code}')">Ã—</button></div>`;
    }).join('');
}

function updateWork(staff, shift, value) {
    if (!currentSchedule[staff]) currentSchedule[staff] = { am: {}, pm: {} };
    if (!currentSchedule[staff][shift]) currentSchedule[staff][shift] = {};
    currentSchedule[staff][shift].work = value;
}

function toggleProduct(staff, shift, productCode) {
    if (!currentSchedule[staff]) currentSchedule[staff] = { am: {}, pm: {} };
    if (!currentSchedule[staff][shift]) currentSchedule[staff][shift] = { products: [] };
    if (!currentSchedule[staff][shift].products) currentSchedule[staff][shift].products = [];
    const products = currentSchedule[staff][shift].products;
    const index = products.indexOf(productCode);
    if (index > -1) products.splice(index, 1); else products.push(productCode);
    document.getElementById(`products-${staff}-${shift}`).innerHTML = renderProductList(staff, shift);
    document.getElementById(`selected-${staff}-${shift}`).innerHTML = renderSelectedProducts(staff, shift);
}

function removeProduct(staff, shift, productCode) { toggleProduct(staff, shift, productCode); }
function filterProducts(staff, shift, filter) { document.getElementById(`products-${staff}-${shift}`).innerHTML = renderProductList(staff, shift, filter); }
function updateNote(staff, shift, value) {
    if (!currentSchedule[staff]) currentSchedule[staff] = { am: {}, pm: {} };
    if (!currentSchedule[staff][shift]) currentSchedule[staff][shift] = {};
    currentSchedule[staff][shift].note = value;
}

function clearAll() {
    if (confirm('ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰è³‡æ–™å—ï¼Ÿ')) { initSchedule(); renderSchedule(); showToast('å·²æ¸…ç©ºæ‰€æœ‰è³‡æ–™'); }
}

function saveSchedule() {
    const date = document.getElementById('scheduleDate').value;
    const data = { date: date, schedule: currentSchedule };
    localStorage.setItem(`schedule_${date}`, JSON.stringify(data));
    showToast('âœ… æ’ç¨‹å·²å„²å­˜');
    const dataStr = JSON.stringify(data, null, 2);
    const dataBlob = new Blob([dataStr], { type: 'application/json' });
    const url = URL.createObjectURL(dataBlob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `æ’ç¨‹_${date}.json`;
    link.click();
}

function showToast(message) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3000);
}

function loadSchedule(date) {
    const saved = localStorage.getItem(`schedule_${date}`);
    if (saved) {
        const data = JSON.parse(saved);
        currentSchedule = data.schedule;
        renderSchedule();
        showToast('å·²è¼‰å…¥æ’ç¨‹');
    }
}

document.getElementById('scheduleDate').addEventListener('change', function() { loadSchedule(this.value); });
initSchedule();
renderSchedule();
loadSchedule(document.getElementById('scheduleDate').value);
    </script>
</body>
</html>
